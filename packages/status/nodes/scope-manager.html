<script type="text/javascript">
  RED.nodes.registerType('scope-manager', {
      category: 'status',
      color: '#DDAA99',
      defaults: {
          name: { value: "" },
          from: { value: "" },
          to: { value: "" },
          controlId: { value: "" },
          level1: { value: "" },
          level2: { value: "" },
          level3: { value: "" },
          scope: { value: "" },
          params: {
            value: {
              from: 'string',
              to: 'string',
              controlId: 'string',
              level1: 'string',
              level2: 'string',
              level3: 'string',
              scope: 'object',
            },
          },
      },
      inputs: 1,
      outputs: 1,
      icon: 'font-awesome/fa-sitemap',
      label: function () {
          return this.name || 'scope-manager';
      }
  });
</script>

<script type="text/x-red" data-template-name="scope-manager">
  <div class="form-row">
      <label for="node-input-name">Name</label>
      <input type="text" id="node-input-name" placeholder="Node Name">
  </div>
  <div class="form-row">
      <label for="node-input-from"><i class="fa fa-calendar"></i> From</label>
      <input type="text" id="node-input-from" placeholder="Start Period">
  </div>
  <div class="form-row">
      <label for="node-input-to"><i class="fa fa-calendar"></i> To</label>
      <input type="text" id="node-input-to" placeholder="End Period">
  </div>
  <div class="form-row">
      <label for="node-input-controlId"><i class="fa fa-id-badge"></i> Control ID</label>
      <input type="text" id="node-input-controlId" placeholder="Control Identifier">
  </div>
  <div class="form-row">
      <label for="node-input-level1">Level 1</label>
      <input type="text" id="node-input-level1" placeholder="First Level">
  </div>
  <div class="form-row">
      <label for="node-input-level2">Level 2</label>
      <input type="text" id="node-input-level2" placeholder="Second Level">
  </div>

  <div class="form-row">
      <label for="node-input-level3">Level 3</label>
      <input type="text" id="node-input-level3" placeholder="Third Level">
  </div>

</script>
<script type="text/x-red" data-help-name="scope-manager">
  <p>
      The <strong>scope-manager</strong> node is responsible for managing hierarchical scope levels within a structured dataset.
  </p>
  <h3>Inputs</h3>
  <dl class="message-properties">
      <dt>payload <span class="property-type">object</span></dt>
      <dd>
          The input data structure should contain an event trace or structured dataset to analyze.
      </dd>
      <dt>from <span class="property-type">string</span></dt>
      <dd>
          The starting period for filtering data.
      </dd>
      <dt>to <span class="property-type">string</span></dt>
      <dd>
          The ending period for filtering data.
      </dd>
      <dt>controlId <span class="property-type">string</span></dt>
      <dd>
          The control ID associated with the dataset.
      </dd>
      <dt>level1, level2, level3 <span class="property-type">string</span></dt>
      <dd>
          The hierarchical levels to search within the dataset. These fields are optional, and if they are not specified, the node will search across all levels in the dataset.
      </dd>
      <dt>scope <span class="property-type">object</span></dt>
      <dd>
          A set of search parameters defining scope-based filtering.
      </dd>
  </dl>

  <h3>Outputs</h3>
  <dl class="message-properties">
      <dt>payload <span class="property-type">object</span></dt>
      <dd>
          The output payload includes:
          <ul>
              <li><code>scope</code>: The refined hierarchical scope.</li>
              <li><code>period</code>: An object containing <code>from</code> and <code>to</code> values.</li>
              <li><code>controlId</code>: The associated control identifier.</li>
          </ul>
      </dd>
  </dl>

  <h3>Details</h3>
  <p>
      This node processes structured data to identify hierarchical relationships. It employs fuzzy search techniques for flexible matching and extracts relevant scope information.
  </p>
</script>
